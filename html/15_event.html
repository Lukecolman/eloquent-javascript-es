<!doctype html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Manejo de Eventos :: Eloquent JavaScript</title>
  <link rel=stylesheet href="css/ejs.css"><script>
      var page = {"type":"chapter","number":15}</script></head>

<article>
<nav><a href="14_dom.html" title="previous chapter" aria-label="previous chapter">‚óÇ</a>¬†<a href="index.html" title="cover" aria-label="cover">‚óè</a>¬†<a href="16_game.html" title="next chapter" aria-label="next chapter">‚ñ∏</a>&nbsp;<button class=help title="help" aria-label="help"><strong>?</strong></button>&nbsp;<button class="dark-mode-toggle">üåô</button>
</nav>

<h1>Manejo de Eventos</h1>

<blockquote>

<p><a class="p_ident" id="p-VUZeGAxBS+" href="#p-VUZeGAxBS+" tabindex="-1" role="presentation"></a>Tienes poder sobre tu mente, no sobre los eventos externos. Date cuenta de esto y encontrar√°s fuerza.</p>

<footer>Marco Aurelio, <cite>Meditaciones</cite></footer>

</blockquote><figure class="chapter framed"><img src="img/chapter_picture_15.jpg" alt="Ilustraci√≥n que muestra una m√°quina de Rube Goldberg que involucra una pelota, una balanza, un par de tijeras y un martillo, los cuales se afectan en una reacci√≥n en cadena que enciende una bombilla."></figure>

<p><a class="p_ident" id="p-7buioHYYih" href="#p-7buioHYYih" tabindex="-1" role="presentation"></a>Algunos programas trabajan con la entrada directa del usuario, como acciones del rat√≥n y del teclado. Ese tipo de entrada no est√° disponible de antemano, como una estructura de datos bien organizada, llega pieza por pieza, en tiempo real, y el programa debe responder a medida que sucede.</p>

<h2><a class="h_ident" id="h-FRSr58jqPG" href="#h-FRSr58jqPG" tabindex="-1" role="presentation"></a>Controladores de Eventos</h2>

<p><a class="p_ident" id="p-8Rhq4iuO+f" href="#p-8Rhq4iuO+f" tabindex="-1" role="presentation"></a>Imagina una interfaz donde la √∫nica forma de saber si una tecla en el teclado est√° siendo presionada es leyendo el estado actual de esa tecla. Para poder reaccionar a las pulsaciones de teclas, tendr√≠as que leer constantemente el estado de la tecla para capturarla antes de que se libere nuevamente. Ser√≠a peligroso realizar otras computaciones intensivas en tiempo, ya que podr√≠as perder una pulsaci√≥n de tecla.</p>

<p><a class="p_ident" id="p-VP41tPOvsN" href="#p-VP41tPOvsN" tabindex="-1" role="presentation"></a>Algunas m√°quinas primitivas manejan la entrada de esa manera. Un paso adelante ser√≠a que el hardware o el sistema operativo noten la pulsaci√≥n de tecla y la pongan en una cola. Un programa puede luego verificar peri√≥dicamente la cola en busca de nuevos eventos y reaccionar a lo que encuentre all√≠.</p>

<p><a class="p_ident" id="p-OA4r/1sP4t" href="#p-OA4r/1sP4t" tabindex="-1" role="presentation"></a>Por supuesto, tiene que recordar mirar la cola y hacerlo a menudo, porque cualquier tiempo transcurrido entre la presi√≥n de la tecla y la notificaci√≥n del evento por parte del programa har√° que el software se sienta sin respuesta. Este enfoque se llama <em>sondeo</em>. La mayor√≠a de los programadores prefieren evitarlo.</p>

<p><a class="p_ident" id="p-2XkwGPIiX5" href="#p-2XkwGPIiX5" tabindex="-1" role="presentation"></a>Un mecanismo mejor es que el sistema notifique activamente a nuestro c√≥digo cuando ocurre un evento. Los navegadores hacen esto al permitirnos registrar funciones como <em>manejadores</em> para eventos espec√≠ficos.</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-oVekYvwKVN" href="#c-oVekYvwKVN" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">p</span>&gt;Haz clic en este documento para activar el manejador.&lt;/<span class="tok-typeName">p</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  window.addEventListener(<span class="tok-string">&quot;click&quot;</span>, () =&gt; {
    console.log(<span class="tok-string">&quot;¬øLlamaste?&quot;</span>);
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-sMSFJq6kop" href="#p-sMSFJq6kop" tabindex="-1" role="presentation"></a>La asignaci√≥n <code>window</code> se refiere a un objeto integrado proporcionado por el navegador. Representa la ventana del navegador que contiene el documento. Llamar a su m√©todo <code>addEventListener</code> registra el segundo argumento para que se llame cada vez que ocurra el evento descrito por su primer argumento.</p>

<h2><a class="h_ident" id="h-i1TmEKGPGX" href="#h-i1TmEKGPGX" tabindex="-1" role="presentation"></a>Eventos y nodos DOM</h2>

<p><a class="p_ident" id="p-KozqhnfqX8" href="#p-KozqhnfqX8" tabindex="-1" role="presentation"></a>Cada controlador de eventos del navegador se registra en un contexto. En el ejemplo anterior llamamos a <code>addEventListener</code> en el objeto <code>window</code> para registrar un controlador para toda la ventana. Un m√©todo similar tambi√©n se encuentra en elementos del DOM y algunos otros tipos de objetos. Los escuchas de eventos solo se llaman cuando el evento ocurre en el contexto del objeto en el que est√°n registrados.</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-cgGEoZtMBf" href="#c-cgGEoZtMBf" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">button</span>&gt;Haz clic&lt;/<span class="tok-typeName">button</span>&gt;
&lt;<span class="tok-typeName">p</span>&gt;No hay manejador aqu√≠.&lt;/<span class="tok-typeName">p</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-keyword">let</span> <span class="tok-definition">button</span> = document.querySelector(<span class="tok-string">&quot;button&quot;</span>);
  button.addEventListener(<span class="tok-string">&quot;click&quot;</span>, () =&gt; {
    console.log(<span class="tok-string">&quot;Bot√≥n clickeado.&quot;</span>);
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-qcV8LJi52o" href="#p-qcV8LJi52o" tabindex="-1" role="presentation"></a>Ese ejemplo adjunta un manejador al nodo del bot√≥n. Los clics en el bot√≥n hacen que se ejecute ese manejador, pero los clics en el resto del documento no lo hacen.</p>

<p><a class="p_ident" id="p-ULEZ9TcmUH" href="#p-ULEZ9TcmUH" tabindex="-1" role="presentation"></a>Darle a un nodo un atributo <code>onclick</code> tiene un efecto similar. Esto funciona para la mayor√≠a de tipos de eventos: puedes adjuntar un manejador a trav√©s del atributo cuyo nombre es el nombre del evento con <code>on</code> al inicio.</p>

<p><a class="p_ident" id="p-jwX/IrUZx/" href="#p-jwX/IrUZx/" tabindex="-1" role="presentation"></a>Pero un nodo solo puede tener un atributo <code>onclick</code>, por lo que solo puedes registrar un manejador por nodo de esa manera. El m√©todo <code>addEventListener</code> te permite agregar cualquier cantidad de manejadores, por lo que es seguro agregar manejadores incluso si ya hay otro manejador en el elemento.</p>

<p><a class="p_ident" id="p-/4LnTySpGj" href="#p-/4LnTySpGj" tabindex="-1" role="presentation"></a>El m√©todo <code>removeEventListener</code>, llamado con argumentos similares a <code>addEventListener</code>, remueve un manejador.</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-BYy+V/MPJt" href="#c-BYy+V/MPJt" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">button</span>&gt;Bot√≥n de acci√≥n √∫nica&lt;/<span class="tok-typeName">button</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-keyword">let</span> <span class="tok-definition">button</span> = document.querySelector(<span class="tok-string">&quot;button&quot;</span>);
  <span class="tok-keyword">function</span> <span class="tok-definition">unaVez</span>() {
    console.log(<span class="tok-string">&quot;¬°Hecho!&quot;</span>);
    button.removeEventListener(<span class="tok-string">&quot;click&quot;</span>, unaVez);
  }
  button.addEventListener(<span class="tok-string">&quot;click&quot;</span>, unaVez);
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-8jkibmkt7W" href="#p-8jkibmkt7W" tabindex="-1" role="presentation"></a>La funci√≥n proporcionada a <code>removeEventListener</code> debe ser el mismo valor de funci√≥n que se proporcion√≥ a <code>addEventListener</code>. Por lo tanto, para anular el registro de un manejador, querr√°s darle un nombre a la funci√≥n (<code>unaVez</code>, en el ejemplo) para poder pasar el mismo valor de funci√≥n a ambos m√©todos.</p>

<h2><a class="h_ident" id="h-KlpBrbTtf/" href="#h-KlpBrbTtf/" tabindex="-1" role="presentation"></a>Objetos de eventos</h2>

<p><a class="p_ident" id="p-EfRG8R9jxW" href="#p-EfRG8R9jxW" tabindex="-1" role="presentation"></a>Aunque lo hemos ignorado hasta ahora, las funciones de manejadores de eventos reciben un argumento: el <em>objeto de evento</em>. Este objeto contiene informaci√≥n adicional sobre el evento. Por ejemplo, si queremos saber <em>cu√°l</em> bot√≥n del mouse se presion√≥, podemos mirar la propiedad <code>button</code> del objeto de evento.</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-1XU8X2K94Z" href="#c-1XU8X2K94Z" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">button</span>&gt;Haz clic como quieras&lt;/<span class="tok-typeName">button</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-keyword">let</span> <span class="tok-definition">button</span> = document.querySelector(<span class="tok-string">&quot;button&quot;</span>);
  button.addEventListener(<span class="tok-string">&quot;mousedown&quot;</span>, <span class="tok-definition">event</span> =&gt; {
    <span class="tok-keyword">if</span> (event.button == <span class="tok-number">0</span>) {
      console.log(<span class="tok-string">&quot;Bot√≥n izquierdo&quot;</span>);
    } <span class="tok-keyword">else</span> <span class="tok-keyword">if</span> (event.button == <span class="tok-number">1</span>) {
      console.log(<span class="tok-string">&quot;Bot√≥n del medio&quot;</span>);
    } <span class="tok-keyword">else</span> <span class="tok-keyword">if</span> (event.button == <span class="tok-number">2</span>) {
      console.log(<span class="tok-string">&quot;Bot√≥n derecho&quot;</span>);
    }
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-HlzOSkQJuU" href="#p-HlzOSkQJuU" tabindex="-1" role="presentation"></a>La informaci√≥n almacenada en un objeto de evento difiere seg√∫n el tipo de evento. Discutiremos diferentes tipos m√°s adelante en el cap√≠tulo. La propiedad <code>type</code> del objeto siempre contiene una cadena que identifica el evento (como <code>&quot;click&quot;</code> o <code>&quot;mousedown&quot;</code>).</p>

<h2><a class="h_ident" id="h-4NLRTYLmHH" href="#h-4NLRTYLmHH" tabindex="-1" role="presentation"></a>Propagaci√≥n</h2>

<p><a class="p_ident" id="p-eiMQVYI0Vr" href="#p-eiMQVYI0Vr" tabindex="-1" role="presentation"></a>Para la mayor√≠a de tipos de evento, los manejadores registrados en nodos con hijos tambi√©n recibir√°n eventos que ocurran en los hijos. Si se hace clic en un bot√≥n dentro de un p√°rrafo, los manejadores de eventos en el p√°rrafo tambi√©n ver√°n el evento de clic.</p>

<p><a class="p_ident" id="p-LrSHxLbszG" href="#p-LrSHxLbszG" tabindex="-1" role="presentation"></a>Pero si tanto el p√°rrafo como el bot√≥n tienen un controlador, el controlador m√°s espec√≠fico ‚Äîel del bot√≥n‚Äî tiene prioridad para ejecutarse primero. Se dice que el evento <em>se propaga</em> hacia afuera, desde el nodo donde ocurri√≥ hacia el nodo padre de ese nodo y hasta la ra√≠z del documento. Finalmente, despu√©s de que todos los controladores registrados en un nodo espec√≠fico hayan tenido su turno, los controladores registrados en toda la ventana tienen la oportunidad de responder al evento.</p>

<p><a class="p_ident" id="p-bLFObMVe5V" href="#p-bLFObMVe5V" tabindex="-1" role="presentation"></a>En cualquier momento, un controlador de eventos puede llamar al m√©todo <code>stopPropagation</code> en el objeto de evento para evitar que los controladores superiores reciban el evento. Esto puede ser √∫til cuando, por ejemplo, tienes un bot√≥n dentro de otro elemento clickeable y no quieres que los clics en el bot√≥n activen el comportamiento de click del elemento externo.</p>

<p><a class="p_ident" id="p-VouwaRKuxI" href="#p-VouwaRKuxI" tabindex="-1" role="presentation"></a>El siguiente ejemplo registra controladores de <code>&quot;mousedown&quot;</code> tanto en un bot√≥n como en el p√°rrafo que lo rodea. Cuando se hace clic con el bot√≥n derecho del rat√≥n, el controlador del bot√≥n llama a <code>stopPropagation</code>, lo que evitar√° que se ejecute el controlador en el p√°rrafo. Cuando el bot√≥n se hace clic con otro bot√≥n del rat√≥n, ambos controladores se ejecutar√°n.</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-VU+8jIYijA" href="#c-VU+8jIYijA" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">p</span>&gt;Un p√°rrafo con un &lt;<span class="tok-typeName">button</span>&gt;bot√≥n&lt;/<span class="tok-typeName">button</span>&gt;.&lt;/<span class="tok-typeName">p</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-keyword">let</span> <span class="tok-definition">para</span> = document.querySelector(<span class="tok-string">&quot;p&quot;</span>);
  <span class="tok-keyword">let</span> <span class="tok-definition">button</span> = document.querySelector(<span class="tok-string">&quot;button&quot;</span>);
  para.addEventListener(<span class="tok-string">&quot;mousedown&quot;</span>, () =&gt; {
    console.log(<span class="tok-string">&quot;Controlador para el p√°rrafo.&quot;</span>);
  });
  button.addEventListener(<span class="tok-string">&quot;mousedown&quot;</span>, <span class="tok-definition">event</span> =&gt; {
    console.log(<span class="tok-string">&quot;Controlador para el bot√≥n.&quot;</span>);
    <span class="tok-keyword">if</span> (event.button == <span class="tok-number">2</span>) event.stopPropagation();
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-5Nvc1U9zZK" href="#p-5Nvc1U9zZK" tabindex="-1" role="presentation"></a>La mayor√≠a de los objetos de eventos tienen una propiedad <code>target</code> que se refiere al nodo donde se originaron. Puedes usar esta propiedad para asegurarte de que no est√°s manejando accidentalmente algo que se propag√≥ desde un nodo que no deseas manejar.</p>

<p><a class="p_ident" id="p-AV6INcWyLH" href="#p-AV6INcWyLH" tabindex="-1" role="presentation"></a>Tambi√©n es posible usar la propiedad <code>target</code> para abarcar un amplio rango para un tipo espec√≠fico de evento. Por ejemplo, si tienes un nodo que contiene una larga lista de botones, puede ser m√°s conveniente registrar un √∫nico controlador de clic en el nodo externo y hacer que utilice la propiedad <code>target</code> para averiguar si se hizo clic en un bot√≥n, en lugar de registrar controladores individuales en todos los botones.</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-prAkJsIl5b" href="#c-prAkJsIl5b" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">button</span>&gt;A&lt;/<span class="tok-typeName">button</span>&gt;
&lt;<span class="tok-typeName">button</span>&gt;B&lt;/<span class="tok-typeName">button</span>&gt;
&lt;<span class="tok-typeName">button</span>&gt;C&lt;/<span class="tok-typeName">button</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  document.body.addEventListener(<span class="tok-string">&quot;click&quot;</span>, <span class="tok-definition">event</span> =&gt; {
    <span class="tok-keyword">if</span> (event.target.nodeName == <span class="tok-string">&quot;BUTTON&quot;</span>) {
      console.log(<span class="tok-string">&quot;Clic en&quot;</span>, event.target.textContent);
    }
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<h2><a class="h_ident" id="h-6R7Ptf/aVU" href="#h-6R7Ptf/aVU" tabindex="-1" role="presentation"></a>Acciones predeterminadas</h2>

<p><a class="p_ident" id="p-R2pr2N9dn+" href="#p-R2pr2N9dn+" tabindex="-1" role="presentation"></a>Muchos eventos tienen una acci√≥n predeterminada asociada a ellos. Si haces clic en un enlace, ser√°s llevado al destino del enlace. Si presionas la flecha hacia abajo, el navegador desplazar√° la p√°gina hacia abajo. Si haces clic derecho, obtendr√°s un men√∫ contextual. Y as√≠ sucesivamente.</p>

<p><a class="p_ident" id="p-eCArhCpoYq" href="#p-eCArhCpoYq" tabindex="-1" role="presentation"></a>Para la mayor√≠a de los tipos de eventos, los controladores de eventos de JavaScript se ejecutan <em>antes</em> de que ocurra el comportamiento predeterminado. Si el controlador no desea que este comportamiento normal ocurra, t√≠picamente porque ya se encarg√≥ de manejar el evento, puede llamar al m√©todo <code>preventDefault</code> en el objeto de evento.</p>

<p><a class="p_ident" id="p-RY97vdby+n" href="#p-RY97vdby+n" tabindex="-1" role="presentation"></a>Esto se puede utilizar para implementar tus propios atajos de teclado o men√∫s contextuales. Tambi√©n se puede usar para interferir de manera molesta con el comportamiento que los usuarios esperan. Por ejemplo, aqu√≠ hay un enlace que no se puede seguir:</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-sGqQCQuHVQ" href="#c-sGqQCQuHVQ" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">a</span> href=<span class="tok-string">&quot;https://developer.mozilla.org/&quot;</span>&gt;MDN&lt;/<span class="tok-typeName">a</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-keyword">let</span> <span class="tok-definition">link</span> = document.querySelector(<span class="tok-string">&quot;a&quot;</span>);
  link.addEventListener(<span class="tok-string">&quot;click&quot;</span>, <span class="tok-definition">event</span> =&gt; {
    console.log(<span class="tok-string">&quot;¬°Incorrecto!&quot;</span>);
    event.preventDefault();
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-H9L0J5B5xg" href="#p-H9L0J5B5xg" tabindex="-1" role="presentation"></a>Trata de no hacer este tipo de cosas a menos que tengas una raz√≥n realmente v√°lida. Ser√° desagradable para las personas que utilicen tu p√°gina cuando se rompa el comportamiento esperado.</p>

<p><a class="p_ident" id="p-eCmiVPHlxu" href="#p-eCmiVPHlxu" tabindex="-1" role="presentation"></a>Dependiendo del navegador, algunos eventos no se pueden interceptar en absoluto. En Chrome, por ejemplo, el atajo de teclado para cerrar la pesta√±a actual (control-W o command-W) no se puede manejar con JavaScript.</p>

<h2><a class="h_ident" id="h-eLNw0KdiHA" href="#h-eLNw0KdiHA" tabindex="-1" role="presentation"></a>Eventos de teclado</h2>

<p><a class="p_ident" id="p-wp8+LsBC/U" href="#p-wp8+LsBC/U" tabindex="-1" role="presentation"></a>Cuando se presiona una tecla en el teclado, tu navegador dispara un evento <code>&quot;keydown&quot;</code>. Cuando se suelta, obtienes un evento <code>&quot;keyup&quot;</code>.</p>

<pre tabindex="0" class="snippet" data-language="html"  data-focus="true"><a class="c_ident" id="c-lRps+rMLij" href="#c-lRps+rMLij" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">p</span>&gt;Esta p√°gina se vuelve violeta cuando mantienes presionada la tecla V.&lt;/<span class="tok-typeName">p</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  window.addEventListener(<span class="tok-string">&quot;keydown&quot;</span>, <span class="tok-definition">event</span> =&gt; {
    <span class="tok-keyword">if</span> (event.key == <span class="tok-string">&quot;v&quot;</span>) {
      document.body.style.background = <span class="tok-string">&quot;violet&quot;</span>;
    }
  });
  window.addEventListener(<span class="tok-string">&quot;keyup&quot;</span>, <span class="tok-definition">event</span> =&gt; {
    <span class="tok-keyword">if</span> (event.key == <span class="tok-string">&quot;v&quot;</span>) {
      document.body.style.background = <span class="tok-string">&quot;&quot;</span>;
    }
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-/uBKiqvFy0" href="#p-/uBKiqvFy0" tabindex="-1" role="presentation"></a>A pesar de su nombre, <code>&quot;keydown&quot;</code> se dispara no solo cuando la tecla se presiona f√≠sicamente hacia abajo. Cuando se presiona y se mantiene una tecla, el evento se vuelve a disparar cada vez que la tecla <em>se repite</em>. A veces tienes que tener cuidado con esto. Por ejemplo, si agregas un bot√≥n al DOM cuando se presiona una tecla y lo eliminas de nuevo cuando se suelta la tecla, podr√≠as agregar accidentalmente cientos de botones cuando se mantiene presionada la tecla durante m√°s tiempo.</p>

<p><a class="p_ident" id="p-I4C4KO6VjA" href="#p-I4C4KO6VjA" tabindex="-1" role="presentation"></a>El ejemplo observ√≥ la propiedad <code>key</code> del objeto evento para ver sobre qu√© tecla es el evento. Esta propiedad contiene una cadena que, para la mayor√≠a de las teclas, corresponde a lo que escribir√≠as al presionar esa tecla. Para teclas especiales como <span class="keyname">enter</span>, contiene una cadena que nombra la tecla (<code>&quot;Enter&quot;</code>, en este caso). Si mantienes presionado <span class="keyname">shift</span> mientras presionas una tecla, eso tambi√©n puede influir en el nombre de la tecla: <code>&quot;v&quot;</code> se convierte en <code>&quot;V&quot;</code>, y <code>&quot;1&quot;</code> puede convertirse en <code>&quot;!&quot;</code>, si eso es lo que produce al presionar <span class="keyname">shift</span>-1 en tu teclado.</p>

<p><a class="p_ident" id="p-GTiYNx18vJ" href="#p-GTiYNx18vJ" tabindex="-1" role="presentation"></a>Las teclas modificadoras como <span class="keyname">shift</span>, <span class="keyname">control</span>, <span class="keyname">alt</span> y <span class="keyname">meta</span> (command en Mac) generan eventos de tecla igual que las teclas normales. Pero al buscar combinaciones de teclas, tambi√©n puedes averiguar si estas teclas se mantienen presionadas mirando las propiedades <code>shiftKey</code>, <code>ctrlKey</code>, <code>altKey</code> y <code>metaKey</code> de los eventos de teclado y rat√≥n.</p>

<pre tabindex="0" class="snippet" data-language="html"  data-focus="true"><a class="c_ident" id="c-8SxxAoGtUO" href="#c-8SxxAoGtUO" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">p</span>&gt;Pulsa Control-Espacio para continuar.&lt;/<span class="tok-typeName">p</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  window.addEventListener(<span class="tok-string">&quot;keydown&quot;</span>, <span class="tok-definition">event</span> =&gt; {
    <span class="tok-keyword">if</span> (event.key == <span class="tok-string">&quot; &quot;</span> &amp;&amp; event.ctrlKey) {
      console.log(<span class="tok-string">&quot;¬°Continuando!&quot;</span>);
    }
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-2tFLOxDicw" href="#p-2tFLOxDicw" tabindex="-1" role="presentation"></a>El nodo del DOM donde se origina un evento de teclado depende del elemento que tiene foco cuando se presiona la tecla. La mayor√≠a de los nodos no pueden tener foco a menos que les des un atributo <code>tabindex</code>, pero cosas como los enlaces, botones y campos de formulario pueden. Volveremos a los campos de formulario en el <a href="18_http.html#forms">Cap√≠tulo 18</a>. Cuando nada en particular tiene foco, <code>document.body</code> act√∫a como el nodo objetivo de los eventos de teclado.</p>

<p><a class="p_ident" id="p-24lfblPn/F" href="#p-24lfblPn/F" tabindex="-1" role="presentation"></a>Cuando el usuario est√° escribiendo texto, utilizar eventos de teclado para averiguar qu√© se est√° escribiendo es problem√°tico. Algunas plataformas, especialmente el teclado virtual en tel√©fonos Android, no disparan eventos de teclado. Pero incluso cuando se tiene un teclado tradicional, algunos tipos de entrada de texto no coinciden con las pulsaciones de teclas de manera directa, como el software de <em>editor de m√©todo de entrada</em> (IME) utilizado por personas cuyos guiones no caben en un teclado, donde m√∫ltiples pulsaciones de teclas se combinan para crear caracteres.</p>

<p><a class="p_ident" id="p-PQJVGZpm4G" href="#p-PQJVGZpm4G" tabindex="-1" role="presentation"></a>Para detectar cuando se ha escrito algo, los elementos en los que se puede escribir, como las etiquetas <code>&lt;input&gt;</code> y <code>&lt;textarea&gt;</code>, activan eventos <code>&quot;input&quot;</code> cada vez que el usuario cambia su contenido. Para obtener el contenido real que se ha escrito, lo mejor es leerlo directamente del campo enfocado. <a href="18_http.html#forms">Cap√≠tulo 18</a> mostrar√° c√≥mo hacerlo.</p>

<h2><a class="h_ident" id="h-AYhl2kjrOW" href="#h-AYhl2kjrOW" tabindex="-1" role="presentation"></a>Eventos de puntero</h2>

<p><a class="p_ident" id="p-6Y0Y9AhTlQ" href="#p-6Y0Y9AhTlQ" tabindex="-1" role="presentation"></a>Actualmente existen dos formas ampliamente utilizadas de se√±alar cosas en una pantalla: los ratones (incluyendo dispositivos que act√∫an como ratones, como touchpads y trackballs) y las pantallas t√°ctiles. Estas producen diferentes tipos de eventos.</p>

<h3><a class="i_ident" id="i-ld4kHyEZCM" href="#i-ld4kHyEZCM" tabindex="-1" role="presentation"></a>Clics de rat√≥n</h3>

<p><a class="p_ident" id="p-6QIvunU/eA" href="#p-6QIvunU/eA" tabindex="-1" role="presentation"></a>Presionar un bot√≥n de rat√≥n provoca que se disparen varios eventos. Los eventos <code>&quot;mousedown&quot;</code> y <code>&quot;mouseup&quot;</code> son similares a <code>&quot;keydown&quot;</code> y <code>&quot;keyup&quot;</code> y se activan cuando se presiona y se suelta el bot√≥n. Estos eventos ocurren en los nodos del DOM que est√°n inmediatamente debajo del puntero del rat√≥n cuando se produce el evento.</p>

<p><a class="p_ident" id="p-gHgOyxznTg" href="#p-gHgOyxznTg" tabindex="-1" role="presentation"></a>Despu√©s del evento <code>&quot;mouseup&quot;</code>, se dispara un evento <code>&quot;click&quot;</code> en el nodo m√°s espec√≠fico que conten√≠a tanto la pulsaci√≥n como la liberaci√≥n del bot√≥n. Por ejemplo, si presiono el bot√≥n del rat√≥n en un p√°rrafo y luego muevo el puntero a otro p√°rrafo y suelto el bot√≥n, el evento <code>&quot;click&quot;</code> ocurrir√° en el elemento que contiene ambos p√°rrafos.</p>

<p><a class="p_ident" id="p-VTiFjJPIru" href="#p-VTiFjJPIru" tabindex="-1" role="presentation"></a>Si dos clics ocurren cerca uno del otro, tambi√©n se dispara un evento <code>&quot;dblclick&quot;</code> (doble clic), despu√©s del segundo evento de clic.</p>

<p><a class="p_ident" id="p-bCo6gVY4HL" href="#p-bCo6gVY4HL" tabindex="-1" role="presentation"></a>Para obtener informaci√≥n precisa sobre el lugar donde ocurri√≥ un evento de rat√≥n, puedes mirar sus propiedades <code>clientX</code> y <code>clientY</code>, que contienen las coordenadas del evento (en p√≠xeles) relativas a la esquina superior izquierda de la ventana, o <code>pageX</code> y <code>pageY</code>, que son relativas a la esquina superior izquierda de todo el documento (lo cual puede ser diferente cuando la ventana ha sido desplazada).</p>

<p id="dibujo con rat√≥n"><a class="p_ident" id="p-u6ObYcInxf" href="#p-u6ObYcInxf" tabindex="-1" role="presentation"></a>El siguiente programa implementa una aplicaci√≥n de dibujo primitiva. Cada vez que haces clic en el documento, agrega un punto bajo el puntero de tu rat√≥n. Ver <a href="19_paint.html">Cap√≠tulo 19</a> para una aplicaci√≥n de dibujo menos primitiva.</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-vLkN71+z+e" href="#c-vLkN71+z+e" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">style</span>&gt;
  <span class="tok-typeName">body</span> {
    height: <span class="tok-number">200</span><span class="tok-keyword">px</span>;
    background: <span class="tok-atom">beige</span>;
  }
  .dot {
    height: <span class="tok-number">8</span><span class="tok-keyword">px</span>; width: <span class="tok-number">8</span><span class="tok-keyword">px</span>;
    border-radius: <span class="tok-number">4</span><span class="tok-keyword">px</span>; <span class="tok-comment">/* redondea las esquinas */</span>
    background: <span class="tok-atom">teal</span>;
    position: <span class="tok-atom">absolute</span>;
  }
&lt;/<span class="tok-typeName">style</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  window.addEventListener(<span class="tok-string">&quot;click&quot;</span>, <span class="tok-definition">event</span> =&gt; {
    <span class="tok-keyword">let</span> <span class="tok-definition">dot</span> = document.createElement(<span class="tok-string">&quot;div&quot;</span>);
    dot.className = <span class="tok-string">&quot;dot&quot;</span>;
    dot.style.left = (event.pageX - <span class="tok-number">4</span>) + <span class="tok-string">&quot;px&quot;</span>;
    dot.style.top = (event.pageY - <span class="tok-number">4</span>) + <span class="tok-string">&quot;px&quot;</span>;
    document.body.appendChild(dot);
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<h3><a class="i_ident" id="i-uAoy9QjKsj" href="#i-uAoy9QjKsj" tabindex="-1" role="presentation"></a>Movimiento del rat√≥n</h3>

<p><a class="p_ident" id="p-wmFbB/1fGJ" href="#p-wmFbB/1fGJ" tabindex="-1" role="presentation"></a>Cada vez que el puntero del rat√≥n se mueve, se dispara un evento <code>&quot;mousemove&quot;</code>. Este evento se puede usar para rastrear la posici√≥n del rat√≥n. Una situaci√≥n com√∫n en la que esto es √∫til es al implementar alg√∫n tipo de funcionalidad de arrastrar y soltar con el rat√≥n.</p>

<p><a class="p_ident" id="p-2QDCAMGt0z" href="#p-2QDCAMGt0z" tabindex="-1" role="presentation"></a>Como ejemplo, el siguiente programa muestra una barra y configura controladores de eventos para que al arrastrar hacia la izquierda o hacia la derecha en esta barra, se haga m√°s estrecha o m√°s ancha:</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-UTKlG/Tbre" href="#c-UTKlG/Tbre" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">p</span>&gt;Arrastra la barra para cambiar su anchura:&lt;/<span class="tok-typeName">p</span>&gt;
&lt;<span class="tok-typeName">div</span> style=<span class="tok-string">&quot;</span>background: <span class="tok-atom">orange</span>; width: <span class="tok-number">60</span><span class="tok-keyword">px</span>; height: <span class="tok-number">20</span><span class="tok-keyword">px</span><span class="tok-string">&quot;</span>&gt;
&lt;/<span class="tok-typeName">div</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-keyword">let</span> <span class="tok-definition">lastX</span>; <span class="tok-comment">// Rastrea la √∫ltima posici√≥n X del rat√≥n observada</span>
  <span class="tok-keyword">let</span> <span class="tok-definition">bar</span> = document.querySelector(<span class="tok-string">&quot;div&quot;</span>);
  bar.addEventListener(<span class="tok-string">&quot;mousedown&quot;</span>, <span class="tok-definition">event</span> =&gt; {
    <span class="tok-keyword">if</span> (event.button == <span class="tok-number">0</span>) {
      lastX = event.clientX;
      window.addEventListener(<span class="tok-string">&quot;mousemove&quot;</span>, moved);
      event.preventDefault(); <span class="tok-comment">// Prevenir selecci√≥n</span>
    }
  });

  <span class="tok-keyword">function</span> <span class="tok-definition">moved</span>(<span class="tok-definition">event</span>) {
    <span class="tok-keyword">if</span> (event.buttons == <span class="tok-number">0</span>) {
      window.removeEventListener(<span class="tok-string">&quot;mousemove&quot;</span>, moved);
    } <span class="tok-keyword">else</span> {
      <span class="tok-keyword">let</span> <span class="tok-definition">dist</span> = event.clientX - lastX;
      <span class="tok-keyword">let</span> <span class="tok-definition">newWidth</span> = Math.max(<span class="tok-number">10</span>, bar.offsetWidth + dist);
      bar.style.width = newWidth + <span class="tok-string">&quot;px&quot;</span>;
      lastX = event.clientX;
    }
  }
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-fI+m6ASEUA" href="#p-fI+m6ASEUA" tabindex="-1" role="presentation"></a>Ten en cuenta que el controlador <code>&quot;mousemove&quot;</code> est√° registrado en toda la window. Incluso si el rat√≥n sale de la barra durante el cambio de tama√±o, mientras el bot√≥n se mantenga presionado todav√≠a queremos actualizar su tama√±o.</p>

<p><a class="p_ident" id="p-khR2v5y/R0" href="#p-khR2v5y/R0" tabindex="-1" role="presentation"></a>Debemos detener el cambio de tama√±o de la barra cuando se libere el bot√≥n del rat√≥n. Para eso, podemos usar la propiedad <code>buttons</code> (notar el plural), que nos indica qu√© botones est√°n actualmente presionados. Cuando este valor es cero, ning√∫n bot√≥n est√° presionado. Cuando se mantienen presionados botones, su valor es la suma de los c√≥digos de esos botones‚Äîel bot√≥n izquierdo tiene el c√≥digo 1, el derecho 2 y el central 4. Con el bot√≥n izquierdo y el derecho presionados, por ejemplo, el valor de <code>buttons</code> ser√° 3.</p>

<p><a class="p_ident" id="p-lvY87c8VFr" href="#p-lvY87c8VFr" tabindex="-1" role="presentation"></a>Es importante destacar que el orden de estos c√≥digos es diferente al utilizado por <code>button</code>, donde el bot√≥n central ven√≠a antes que el derecho. Como se mencion√≥, la consistencia no es realmente un punto fuerte de la interfaz de programaci√≥n del navegador.</p>

<h3><a class="i_ident" id="i-QH29N+27Jo" href="#i-QH29N+27Jo" tabindex="-1" role="presentation"></a>Eventos t√°ctiles</h3>

<p><a class="p_ident" id="p-3qJEJXxC/X" href="#p-3qJEJXxC/X" tabindex="-1" role="presentation"></a>El estilo de navegador gr√°fico que usamos fue dise√±ado pensando en interfaces de rat√≥n, en una √©poca donde las pantallas t√°ctiles eran raras. Para hacer que la web ‚Äúfuncione‚Äù en los primeros tel√©fonos con pantalla t√°ctil, los navegadores de esos dispositivos fing√≠an, hasta cierto punto, que los eventos t√°ctiles eran eventos de rat√≥n. Si tocas la pantalla, recibir√°s eventos de <code>&quot;mousedown&quot;</code>, <code>&quot;mouseup&quot;</code> y <code>&quot;click&quot;</code>.</p>

<p><a class="p_ident" id="p-FMkG1NPMsu" href="#p-FMkG1NPMsu" tabindex="-1" role="presentation"></a>Pero esta ilusi√≥n no es muy robusta. Una pantalla t√°ctil funciona de manera diferente a un rat√≥n: no tiene m√∫ltiples botones, no se puede rastrear el dedo cuando no est√° en la pantalla (para simular <code>&quot;mousemove&quot;</code>), y permite que varios dedos est√©n en la pantalla al mismo tiempo.</p>

<p><a class="p_ident" id="p-h68paN5HEy" href="#p-h68paN5HEy" tabindex="-1" role="presentation"></a>Los eventos de rat√≥n solo cubren la interacci√≥n t√°ctil en casos sencillos: si agregas un controlador de <code>&quot;click&quot;</code> a un bot√≥n, los usuarios t√°ctiles a√∫n podr√°n usarlo. Pero algo como la barra redimensionable del ejemplo anterior no funciona en una pantalla t√°ctil.</p>

<p><a class="p_ident" id="p-n2OW5CUnrz" href="#p-n2OW5CUnrz" tabindex="-1" role="presentation"></a>Existen tipos espec√≠ficos de eventos disparados por la interacci√≥n t√°ctil. Cuando un dedo comienza a tocar la pantalla, se genera un evento <code>&quot;touchstart&quot;</code>. Cuando se mueve mientras toca, se generan eventos <code>&quot;touchmove&quot;</code>. Finalmente, cuando deja de tocar la pantalla, ver√°s un evento <code>&quot;touchend&quot;</code>.</p>

<p><a class="p_ident" id="p-RgqmyZVECT" href="#p-RgqmyZVECT" tabindex="-1" role="presentation"></a>Debido a que muchas pantallas t√°ctiles pueden detectar varios dedos al mismo tiempo, estos eventos no tienen un √∫nico conjunto de coordenadas asociadas. M√°s bien, sus objetos de eventos tienen una propiedad <code>touches</code>, que contiene un objeto similar a un array de puntos, cada uno con sus propias propiedades <code>clientX</code>, <code>clientY</code>, <code>pageX</code> y <code>pageY</code>.</p>

<p><a class="p_ident" id="p-ye0cXsCzXJ" href="#p-ye0cXsCzXJ" tabindex="-1" role="presentation"></a>Podr√≠as hacer algo como esto para mostrar c√≠rculos rojos alrededor de cada dedo que toca:</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-o5U4LM42M9" href="#c-o5U4LM42M9" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">style</span>&gt;
  <span class="tok-typeName">dot</span> { position: <span class="tok-atom">absolute</span>; display: <span class="tok-atom">block</span>;
        border: <span class="tok-number">2</span><span class="tok-keyword">px</span> <span class="tok-atom">solid</span> <span class="tok-atom">red</span>; border-radius: <span class="tok-number">50</span><span class="tok-keyword">px</span>;
        height: <span class="tok-number">100</span><span class="tok-keyword">px</span>; width: <span class="tok-number">100</span><span class="tok-keyword">px</span>; }
&lt;/<span class="tok-typeName">style</span>&gt;
&lt;<span class="tok-typeName">p</span>&gt;Toca esta p√°gina&lt;/<span class="tok-typeName">p</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-keyword">function</span> <span class="tok-definition">update</span>(<span class="tok-definition">event</span>) {
    <span class="tok-keyword">for</span> (<span class="tok-keyword">let</span> <span class="tok-definition">dot</span>; dot = document.querySelector(<span class="tok-string">&quot;dot&quot;</span>);) {
      dot.remove();
    }
    <span class="tok-keyword">for</span> (<span class="tok-keyword">let</span> <span class="tok-definition">i</span> = <span class="tok-number">0</span>; i &lt; event.touches.length; i++) {
      <span class="tok-keyword">let</span> {pageX, pageY} = event.touches[i];
      <span class="tok-keyword">let</span> <span class="tok-definition">dot</span> = document.createElement(<span class="tok-string">&quot;dot&quot;</span>);
      dot.style.left = (pageX - <span class="tok-number">50</span>) + <span class="tok-string">&quot;px&quot;</span>;
      dot.style.top = (pageY - <span class="tok-number">50</span>) + <span class="tok-string">&quot;px&quot;</span>;
      document.body.appendChild(dot);
    }
  }
  window.addEventListener(<span class="tok-string">&quot;touchstart&quot;</span>, update);
  window.addEventListener(<span class="tok-string">&quot;touchmove&quot;</span>, update);
  window.addEventListener(<span class="tok-string">&quot;touchend&quot;</span>, update);
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-3HLdUVc1+r" href="#p-3HLdUVc1+r" tabindex="-1" role="presentation"></a>A menudo querr√°s llamar a <code>preventDefault</code> en los controladores de eventos t√°ctiles para anular el comportamiento predeterminado del navegador (que puede incluir desplazar la p√°gina al deslizar) y evitar que se generen eventos de rat√≥n, para los cuales tambi√©n puedes tener un controlador.</p>

<h2><a class="h_ident" id="h-GirMfi5LMB" href="#h-GirMfi5LMB" tabindex="-1" role="presentation"></a>Eventos de desplazamiento</h2>

<p><a class="p_ident" id="p-53ahV1ZLJz" href="#p-53ahV1ZLJz" tabindex="-1" role="presentation"></a>Cada vez que un elemento se desplaza, se dispara un evento <code>&quot;scroll&quot;</code>. Esto tiene varios usos, como saber qu√© est√° viendo actualmente el usuario (para desactivar animaciones fuera de la pantalla o enviar informes de vigilancia a tu malvada sede) o mostrar alguna indicaci√≥n de progreso (resaltando parte de una tabla de contenidos o mostrando un n√∫mero de p√°gina).El siguiente ejemplo dibuja una barra de progreso sobre el documento y la actualiza para llenarla a medida que se desplaza hacia abajo:</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-7tyBZD/B1O" href="#c-7tyBZD/B1O" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">style</span>&gt;
  #progress {
    border-bottom: <span class="tok-number">2</span><span class="tok-keyword">px</span> <span class="tok-atom">solid</span> <span class="tok-atom">blue</span>;
    width: <span class="tok-number">0</span>;
    position: <span class="tok-atom">fixed</span>;
    top: <span class="tok-number">0</span>; left: <span class="tok-number">0</span>;
  }
&lt;/<span class="tok-typeName">style</span>&gt;
&lt;<span class="tok-typeName">div</span> id=<span class="tok-string">&quot;progress&quot;</span>&gt;&lt;/<span class="tok-typeName">div</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-comment">// Create some content</span>
  document.body.appendChild(document.createTextNode(
    <span class="tok-string">&quot;supercalifragilisticexpialidocious &quot;</span>.repeat(<span class="tok-number">1000</span>)));

  <span class="tok-keyword">let</span> <span class="tok-definition">bar</span> = document.querySelector(<span class="tok-string">&quot;#progress&quot;</span>);
  window.addEventListener(<span class="tok-string">&quot;scroll&quot;</span>, () =&gt; {
    <span class="tok-keyword">let</span> <span class="tok-definition">max</span> = document.body.scrollHeight - innerHeight;
    bar.style.width = <span class="tok-string2">`</span>${(pageYOffset / max) * <span class="tok-number">100</span>}<span class="tok-string2">%`</span>;
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-wyaK3qXoPQ" href="#p-wyaK3qXoPQ" tabindex="-1" role="presentation"></a>Darle a un elemento una <code>position</code> de <code>fixed</code> act√∫a de manera similar a una posici√≥n <code>absolute</code>, pero tambi√©n evita que se desplace junto con el resto del documento. El efecto es hacer que nuestra barra de progreso permanezca en la parte superior. Su ancho se cambia para indicar el progreso actual. Usamos <code>%</code>, en lugar de <code>px</code>, como unidad al establecer el ancho para que el elemento tenga un tama√±o relativo al ancho de la p√°gina.</p>

<p><a class="p_ident" id="p-ZC4hff5qkY" href="#p-ZC4hff5qkY" tabindex="-1" role="presentation"></a>El enlace global <code>innerHeight</code> nos da la altura de la ventana, que debemos restar de la altura total desplazable, ya que no se puede seguir desplazando cuando se llega al final del documento. Tambi√©n existe un <code>innerWidth</code> para el ancho de la ventana. Al dividir <code>pageYOffset</code>, la posici√≥n actual de desplazamiento, por la posici√≥n m√°xima de desplazamiento y multiplicar por 100, obtenemos el porcentaje para la barra de progreso.</p>

<p><a class="p_ident" id="p-+d2fsgi/S8" href="#p-+d2fsgi/S8" tabindex="-1" role="presentation"></a>Llamar a <code>preventDefault</code> en un evento de desplazamiento no impide que ocurra el desplazamiento. De hecho, el controlador de eventos se llama solo <em>despu√©s</em> de que ocurre el desplazamiento.</p>

<h2><a class="h_ident" id="h-Hax528+TkG" href="#h-Hax528+TkG" tabindex="-1" role="presentation"></a>Eventos de enfoque</h2>

<p><a class="p_ident" id="p-PRA9P1NtZm" href="#p-PRA9P1NtZm" tabindex="-1" role="presentation"></a>Cuando un elemento recibe el enfoque, el navegador dispara un evento <code>&quot;focus&quot;</code> en √©l. Cuando pierde el enfoque, el elemento recibe un evento <code>&quot;blur&quot;</code>.</p>

<p><a class="p_ident" id="p-8kzN7NKw/2" href="#p-8kzN7NKw/2" tabindex="-1" role="presentation"></a>A diferencia de los eventos discutidos anteriormente, estos dos eventos no se propagan. Un controlador en un elemento padre no recibe notificaciones cuando un elemento hijo recibe o pierde el enfoque.</p>

<p><a class="p_ident" id="p-D8wyq1oJ5u" href="#p-D8wyq1oJ5u" tabindex="-1" role="presentation"></a>El siguiente ejemplo muestra texto de ayuda para el campo de texto que actualmente tiene el foco:</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-WCzW7hyh0Y" href="#c-WCzW7hyh0Y" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">p</span>&gt;Nombre: &lt;<span class="tok-typeName">input</span> type=<span class="tok-string">&quot;text&quot;</span> data-help=<span class="tok-string">&quot;Tu nombre completo&quot;</span>&gt;&lt;/<span class="tok-typeName">p</span>&gt;
&lt;<span class="tok-typeName">p</span>&gt;Edad: &lt;<span class="tok-typeName">input</span> type=<span class="tok-string">&quot;text&quot;</span> data-help=<span class="tok-string">&quot;Tu edad en a√±os&quot;</span>&gt;&lt;/<span class="tok-typeName">p</span>&gt;
&lt;<span class="tok-typeName">p</span> id=<span class="tok-string">&quot;help&quot;</span>&gt;&lt;/<span class="tok-typeName">p</span>&gt;

&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-keyword">let</span> <span class="tok-definition">help</span> = document.querySelector(<span class="tok-string">&quot;#help&quot;</span>);
  <span class="tok-keyword">let</span> <span class="tok-definition">fields</span> = document.querySelectorAll(<span class="tok-string">&quot;input&quot;</span>);
  <span class="tok-keyword">for</span> (<span class="tok-keyword">let</span> <span class="tok-definition">field</span> <span class="tok-keyword">of</span> Array.from(fields)) {
    field.addEventListener(<span class="tok-string">&quot;focus&quot;</span>, <span class="tok-definition">event</span> =&gt; {
      <span class="tok-keyword">let</span> <span class="tok-definition">text</span> = event.target.getAttribute(<span class="tok-string">&quot;data-help&quot;</span>);
      help.textContent = text;
    });
    field.addEventListener(<span class="tok-string">&quot;blur&quot;</span>, <span class="tok-definition">event</span> =&gt; {
      help.textContent = <span class="tok-string">&quot;&quot;</span>;
    });
  }
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<h2><a class="h_ident" id="h-FDJa9FAIT3" href="#h-FDJa9FAIT3" tabindex="-1" role="presentation"></a>Evento de carga</h2>

<p><a class="p_ident" id="p-9w6U0pMvKv" href="#p-9w6U0pMvKv" tabindex="-1" role="presentation"></a>Cuando una p√°gina termina de cargarse, se dispara el evento <code>&quot;load&quot;</code> en los objetos ventana y cuerpo del documento. Esto se usa a menudo para programar acciones de inicializaci√≥n que requieren que todo el documento haya sido construido. Recuerda que el contenido de las etiquetas <code>&lt;script&gt;</code> se ejecuta inmediatamente cuando se encuentra la etiqueta. Esto puede ser demasiado pronto, por ejemplo, cuando el script necesita hacer algo con partes del documento que aparecen despu√©s de la etiqueta <code>&lt;script&gt;</code>.</p>

<p><a class="p_ident" id="p-p/L0xopzQf" href="#p-p/L0xopzQf" tabindex="-1" role="presentation"></a>Elementos como im√°genes y etiquetas de script que cargan un archivo externo tambi√©n tienen un evento <code>&quot;load&quot;</code> que indica que se cargaron los archivos a los que hacen referencia. Al igual que los eventos relacionados con el enfoque, los eventos de carga no se propagan.</p>

<p><a class="p_ident" id="p-UoAZklI9NR" href="#p-UoAZklI9NR" tabindex="-1" role="presentation"></a>Cuando se cierra una p√°gina o se navega lejos de ella (por ejemplo, al seguir un enlace), se dispara un evento <code>&quot;beforeunload&quot;</code>. El uso principal de este evento es evitar que el usuario pierda accidentalmente su trabajo al cerrar un documento. Si previenes el comportamiento predeterminado en este evento <em>y</em> estableces la propiedad <code>returnValue</code> en el objeto de evento a una cadena, el navegador mostrar√° al usuario un cuadro de di√°logo preguntando si realmente desea abandonar la p√°gina. Ese cuadro de di√°logo podr√≠a incluir tu cadena, pero debido a que algunos sitios maliciosos intentan usar estos cuadros de di√°logo para confundir a las personas y hacer que se queden en su p√°gina para ver anuncios de p√©rdida de peso dudosos, la mayor√≠a de los navegadores ya no los muestran.</p>

<h2 id="timeline"><a class="h_ident" id="h-h3a3U37DpR" href="#h-h3a3U37DpR" tabindex="-1" role="presentation"></a>Eventos y el bucle de eventos</h2>

<p><a class="p_ident" id="p-XL+MT1/Um5" href="#p-XL+MT1/Um5" tabindex="-1" role="presentation"></a>En el contexto del bucle de eventos, como se discuti√≥ en el <a href="11_async.html">Cap√≠tulo 11</a>, los controladores de eventos del navegador se comportan como otras notificaciones as√≠ncronas. Se programan cuando ocurre el evento pero deben esperar a que otros scripts que se est√©n ejecutando terminen antes de tener la oportunidad de ejecutarse.</p>

<p><a class="p_ident" id="p-5QVtRn61a1" href="#p-5QVtRn61a1" tabindex="-1" role="presentation"></a>El hecho de que los eventos solo se puedan procesar cuando no hay nada m√°s en ejecuci√≥n significa que, si el bucle de eventos est√° ocupado con otro trabajo, cualquier interacci√≥n con la p√°gina (que ocurre a trav√©s de eventos) se retrasar√° hasta que haya tiempo para procesarla. Entonces, si programas demasiado trabajo, ya sea con controladores de eventos de larga duraci√≥n o con muchos que se ejecutan r√°pidamente, la p√°gina se volver√° lenta y pesada de usar.</p>

<p><a class="p_ident" id="p-hFlipe/nM6" href="#p-hFlipe/nM6" tabindex="-1" role="presentation"></a>Para casos en los que <em>realmente</em> quieres hacer algo que consume mucho tiempo en segundo plano sin congelar la p√°gina, los navegadores proporcionan algo llamado <em>web workers</em>. Un worker es un proceso de JavaScript que se ejecuta junto al script principal, en su propia l√≠nea de tiempo.</p>

<p><a class="p_ident" id="p-ES+9mz3Jrf" href="#p-ES+9mz3Jrf" tabindex="-1" role="presentation"></a>Imagina que elevar al cuadrado un n√∫mero es una computaci√≥n pesada y de larga duraci√≥n que queremos realizar en un hilo separado. Podr√≠amos escribir un archivo llamado <code>code/<wbr>squareworker.<wbr>js</code> que responda a mensajes calculando un cuadrado y enviando un mensaje de vuelta.</p>

<pre tabindex="0" class="snippet" data-language="javascript" ><a class="c_ident" id="c-FgmodjGwd9" href="#c-FgmodjGwd9" tabindex="-1" role="presentation"></a>addEventListener(<span class="tok-string">&quot;message&quot;</span>, <span class="tok-definition">event</span> =&gt; {
  postMessage(event.data * event.data);
});</pre>

<p><a class="p_ident" id="p-Ir+TqGr7+e" href="#p-Ir+TqGr7+e" tabindex="-1" role="presentation"></a>Para evitar los problemas de tener m√∫ltiples hilos tocando los mismos datos, los workers no comparten su alcance global ni ning√∫n otro dato con el entorno del script principal. En cambio, debes comunicarte con ellos enviando mensajes de ida y vuelta.</p>

<p><a class="p_ident" id="p-N2CbRaMg8i" href="#p-N2CbRaMg8i" tabindex="-1" role="presentation"></a>Este c√≥digo genera un worker que ejecuta ese script, le env√≠a algunos mensajes y muestra las respuestas.</p>

<pre tabindex="0" class="snippet" data-language="javascript" ><a class="c_ident" id="c-KE8jyaemjH" href="#c-KE8jyaemjH" tabindex="-1" role="presentation"></a><span class="tok-keyword">let</span> <span class="tok-definition">squareWorker</span> = <span class="tok-keyword">new</span> Worker(<span class="tok-string">&quot;code/squareworker.js&quot;</span>);
squareWorker.addEventListener(<span class="tok-string">&quot;message&quot;</span>, <span class="tok-definition">event</span> =&gt; {
  console.log(<span class="tok-string">&quot;El worker respondi√≥:&quot;</span>, event.data);
});
squareWorker.postMessage(<span class="tok-number">10</span>);
squareWorker.postMessage(<span class="tok-number">24</span>);</pre>

<p><a class="p_ident" id="p-i0wlZOt8Mj" href="#p-i0wlZOt8Mj" tabindex="-1" role="presentation"></a>La funci√≥n <code>postMessage</code> env√≠a un mensaje, lo que causar√° que se dispare un evento <code>&quot;message&quot;</code> en el receptor. El script que cre√≥ el worker env√≠a y recibe mensajes a trav√©s del objeto <code>Worker</code>, mientras que el worker se comunica con el script que lo cre√≥ enviando y escuchando directamente en su alcance global. Solo se pueden enviar como mensajes valores que puedan representarse como JSON; el otro lado recibir√° una <em>copia</em> de ellos en lugar del valor en s√≠ mismo.</p>

<h2><a class="h_ident" id="h-5Aaz8MIkVH" href="#h-5Aaz8MIkVH" tabindex="-1" role="presentation"></a>Temporizadores</h2>

<p><a class="p_ident" id="p-WV11KfB182" href="#p-WV11KfB182" tabindex="-1" role="presentation"></a>Vimos la funci√≥n <code>setTimeout</code> en el <a href="11_async.html">Cap√≠tulo 11</a>. Programa otra funci√≥n para que se llame m√°s tarde, despu√©s de un cierto n√∫mero de milisegundos.</p>

<p><a class="p_ident" id="p-s28yPKVQrw" href="#p-s28yPKVQrw" tabindex="-1" role="presentation"></a>A veces necesitas cancelar una funci√≥n que has programado. Esto se hace almacenando el valor devuelto por <code>setTimeout</code> y llamando a <code>clearTimeout</code> sobre √©l.</p>

<pre tabindex="0" class="snippet" data-language="javascript" ><a class="c_ident" id="c-KtFpcnxPz3" href="#c-KtFpcnxPz3" tabindex="-1" role="presentation"></a><span class="tok-keyword">let</span> <span class="tok-definition">bombTimer</span> = setTimeout(() =&gt; {
  console.log(<span class="tok-string">&quot;¬°BOOM!&quot;</span>);
}, <span class="tok-number">500</span>);

<span class="tok-keyword">if</span> (Math.random() &lt; <span class="tok-number">0.5</span>) { <span class="tok-comment">// 50% de probabilidad</span>
  console.log(<span class="tok-string">&quot;Desactivado.&quot;</span>);
  clearTimeout(bombTimer);
}</pre>

<p><a class="p_ident" id="p-FuxjnPqka7" href="#p-FuxjnPqka7" tabindex="-1" role="presentation"></a>La funci√≥n <code>cancelAnimationFrame</code> funciona de la misma manera que <code>clearTimeout</code>; llamarla en un valor devuelto por <code>requestAnimationFrame</code> cancelar√° ese fotograma (si no se ha llamado ya).</p>

<p><a class="p_ident" id="p-et73hwNMcb" href="#p-et73hwNMcb" tabindex="-1" role="presentation"></a>Un conjunto similar de funciones, <code>setInterval</code> y <code>clearInterval</code>, se utilizan para programar temporizadores que deben <em>repetirse</em> cada <em>X</em> milisegundos.</p>

<pre tabindex="0" class="snippet" data-language="javascript" ><a class="c_ident" id="c-TYDPdAHQd3" href="#c-TYDPdAHQd3" tabindex="-1" role="presentation"></a><span class="tok-keyword">let</span> <span class="tok-definition">ticks</span> = <span class="tok-number">0</span>;
<span class="tok-keyword">let</span> <span class="tok-definition">reloj</span> = setInterval(() =&gt; {
  console.log(<span class="tok-string">&quot;tic&quot;</span>, ticks++);
  <span class="tok-keyword">if</span> (ticks == <span class="tok-number">10</span>) {
    clearInterval(reloj);
    console.log(<span class="tok-string">&quot;¬°Detener!&quot;</span>);
  }
}, <span class="tok-number">200</span>);</pre>

<h2><a class="h_ident" id="h-AOVmaqj10I" href="#h-AOVmaqj10I" tabindex="-1" role="presentation"></a>Debouncing</h2>

<p><a class="p_ident" id="p-5gp2VkgPZ9" href="#p-5gp2VkgPZ9" tabindex="-1" role="presentation"></a>Algunos tipos de eventos pueden activarse r√°pidamente, muchas veces seguidas (como los eventos <code>&quot;mousemove&quot;</code> y <code>&quot;scroll&quot;</code>, por ejemplo). Al manejar tales eventos, debes tener cuidado de no hacer nada que consuma demasiado tiempo, ya que tu controlador tomar√° tanto tiempo que la interacci√≥n con el documento comenzar√° a sentirse lenta.</p>

<p><a class="p_ident" id="p-7uuS+8eiFw" href="#p-7uuS+8eiFw" tabindex="-1" role="presentation"></a>Si necesitas hacer algo importante en un controlador de este tipo, puedes usar <code>setTimeout</code> para asegurarte de que no lo est√°s haciendo con demasiada frecuencia. Esto suele llamarse <em>debouncing</em> el evento. Hay varios enfoques ligeramente diferentes para esto.</p>

<p><a class="p_ident" id="p-+/dVlFxtVJ" href="#p-+/dVlFxtVJ" tabindex="-1" role="presentation"></a>En el primer ejemplo, queremos reaccionar cuando el usuario ha escrito algo, pero no queremos hacerlo inmediatamente para cada evento de entrada. Cuando est√°n escribiendo r√°pidamente, solo queremos esperar hasta que ocurra una pausa. En lugar de realizar inmediatamente una acci√≥n en el controlador de eventos, establecemos un tiempo de espera. Tambi√©n limpiamos el tiempo de espera anterior (si existe) para que cuando los eventos ocurran cerca uno del otro (m√°s cerca de nuestro retraso de tiempo de espera), el tiempo de espera del evento anterior se cancele.</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-3gKPMnlx9a" href="#c-3gKPMnlx9a" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">textarea</span>&gt;Escribe algo aqu√≠...&lt;/<span class="tok-typeName">textarea</span>&gt;
&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-keyword">let</span> <span class="tok-definition">textarea</span> = document.querySelector(<span class="tok-string">&quot;textarea&quot;</span>);
  <span class="tok-keyword">let</span> <span class="tok-definition">timeout</span>;
  textarea.addEventListener(<span class="tok-string">&quot;input&quot;</span>, () =&gt; {
    clearTimeout(timeout);
    timeout = setTimeout(() =&gt; console.log(<span class="tok-string">&quot;¬°Escrito!&quot;</span>), <span class="tok-number">500</span>);
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<p><a class="p_ident" id="p-ryGxTuda6B" href="#p-ryGxTuda6B" tabindex="-1" role="presentation"></a>Dar un valor no definido a <code>clearTimeout</code> o llamarlo en un tiempo de espera que ya ha pasado no tiene efecto. Por lo tanto, no tenemos que tener cuidado de cu√°ndo llamarlo, y simplemente lo hacemos para cada evento.</p>

<p><a class="p_ident" id="p-XG0GpvZAFO" href="#p-XG0GpvZAFO" tabindex="-1" role="presentation"></a>Podemos usar un patr√≥n ligeramente diferente si queremos espaciar las respuestas para que est√©n separadas por al menos una cierta longitud de tiempo, pero queremos activarlas <em>durante</em> una serie de eventos, no solo despu√©s. Por ejemplo, podr√≠amos querer responder a eventos <code>&quot;mousemove&quot;</code> mostrando las coordenadas actuales del mouse pero solo cada 250 milisegundos.</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-iNs9SdbBE1" href="#c-iNs9SdbBE1" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-keyword">let</span> <span class="tok-definition">programado</span> = <span class="tok-keyword">null</span>;
  window.addEventListener(<span class="tok-string">&quot;mousemove&quot;</span>, <span class="tok-definition">event</span> =&gt; {
    <span class="tok-keyword">if</span> (!programado) {
      setTimeout(() =&gt; {
        document.body.textContent =
          <span class="tok-string2">`Rat√≥n en </span>${programado.pageX}<span class="tok-string2">, </span>${programado.pageY}<span class="tok-string2">`</span>;
        programado = <span class="tok-keyword">null</span>;
      }, <span class="tok-number">250</span>);
    }
    programado = event;
  });
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<h2><a class="h_ident" id="h-NUFOUyK+lw" href="#h-NUFOUyK+lw" tabindex="-1" role="presentation"></a>Resumen</h2>

<p><a class="p_ident" id="p-DHLQ6WkIIW" href="#p-DHLQ6WkIIW" tabindex="-1" role="presentation"></a>Los controladores de eventos hacen posible detectar y reaccionar a eventos que ocurren en nuestra p√°gina web. El m√©todo <code>addEventListener</code> se utiliza para registrar dicho controlador.</p>

<p><a class="p_ident" id="p-BqgD0KonPh" href="#p-BqgD0KonPh" tabindex="-1" role="presentation"></a>Cada evento tiene un tipo (<code>&quot;keydown&quot;</code>, <code>&quot;focus&quot;</code>, y as√≠ sucesivamente) que lo identifica. La mayor√≠a de los eventos se activan en un elemento DOM espec√≠fico y luego se <em>propagan</em> a los ancestros de ese elemento, lo que permite que los controladores asociados a esos elementos los manejen.</p>

<p><a class="p_ident" id="p-h/n+rs4rlN" href="#p-h/n+rs4rlN" tabindex="-1" role="presentation"></a>Cuando se llama a un controlador de eventos, se le pasa un objeto de evento con informaci√≥n adicional sobre el evento. Este objeto tambi√©n tiene m√©todos que nos permiten detener una mayor propagaci√≥n (<code>stopPropagation</code>) y evitar el manejo predeterminado del evento por parte del navegador (<code>preventDefault</code>).</p>

<p><a class="p_ident" id="p-AyW1QVWdzT" href="#p-AyW1QVWdzT" tabindex="-1" role="presentation"></a>Presionar una tecla dispara eventos <code>&quot;keydown&quot;</code> y <code>&quot;keyup&quot;</code>. Presionar un bot√≥n del mouse dispara eventos <code>&quot;mousedown&quot;</code>, <code>&quot;mouseup&quot;</code> y <code>&quot;click&quot;</code>. Mover el mouse dispara eventos <code>&quot;mousemove&quot;</code>. La interacci√≥n con pantallas t√°ctiles dar√° lugar a eventos <code>&quot;touchstart&quot;</code>, <code>&quot;touchmove&quot;</code> y <code>&quot;touchend&quot;</code>.</p>

<p><a class="p_ident" id="p-wWkn17Vg91" href="#p-wWkn17Vg91" tabindex="-1" role="presentation"></a>El desplazamiento se puede detectar con el evento <code>&quot;scroll&quot;</code>, y los cambios de enfoque se pueden detectar con los eventos <code>&quot;focus&quot;</code> y <code>&quot;blur&quot;</code>. Cuando el documento ha terminado de cargarse, se activa un evento <code>&quot;load&quot;</code> en la ventana.</p>

<h2><a class="h_ident" id="h-tkm7ntLto1" href="#h-tkm7ntLto1" tabindex="-1" role="presentation"></a>Ejercicios</h2>

<h3><a class="i_ident" id="i-NaqVfjsbAA" href="#i-NaqVfjsbAA" tabindex="-1" role="presentation"></a>Globo</h3>

<p><a class="p_ident" id="p-b3Hqo7husK" href="#p-b3Hqo7husK" tabindex="-1" role="presentation"></a>Escribe una p√°gina que muestre un globo (usando el emoji de globo, üéà). Cuando presiones la flecha hacia arriba, deber√≠a inflarse (crecer) un 10 por ciento, y cuando presiones la flecha hacia abajo, deber√≠a desinflarse (encoger) un 10 por ciento.</p>

<p><a class="p_ident" id="p-IEP4Bro5Ql" href="#p-IEP4Bro5Ql" tabindex="-1" role="presentation"></a>Puedes controlar el tama√±o del texto (los emoji son texto) estableciendo la propiedad CSS <code>font-size</code> (<code>style.fontSize</code>) en su elemento padre. Recuerda incluir una unidad en el valor, por ejemplo, p√≠xeles (<code>10px</code>).</p>

<p><a class="p_ident" id="p-SyLfo0cRkh" href="#p-SyLfo0cRkh" tabindex="-1" role="presentation"></a>Los nombres de las teclas de flecha son <code>&quot;ArrowUp&quot;</code> y <code>&quot;ArrowDown&quot;</code>. Aseg√∫rate de que las teclas cambien solo el globo, sin hacer scroll en la p√°gina.</p>

<p><a class="p_ident" id="p-HG8VwrW20W" href="#p-HG8VwrW20W" tabindex="-1" role="presentation"></a>Cuando eso funcione, a√±ade una caracter√≠stica en la que, si inflas el globo m√°s all√° de un cierto tama√±o, explote. En este caso, explotar significa que se reemplace con un emoji de üí•, y el manejador de eventos se elimine (para que no se pueda inflar o desinflar la explosi√≥n).</p>

<pre tabindex="0" class="snippet" data-language="html"  data-focus="true"><a class="c_ident" id="c-ptg6udB2Yi" href="#c-ptg6udB2Yi" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">p</span>&gt;üéà&lt;/<span class="tok-typeName">p</span>&gt;

&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-comment">// Tu c√≥digo aqu√≠</span>
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<details class="solution"><summary>Mostrar pistas...</summary><div class="solution-text">

<p><a class="p_ident" id="p-GvD67qYWif" href="#p-GvD67qYWif" tabindex="-1" role="presentation"></a>Querr√°s registrar un manejador para el evento <code>&quot;keydown&quot;</code> y mirar <code>event.key</code> para saber si se presion√≥ la tecla de flecha hacia arriba o hacia abajo.</p>

<p><a class="p_ident" id="p-FChVTGCUI7" href="#p-FChVTGCUI7" tabindex="-1" role="presentation"></a>El tama√±o actual se puede mantener en un enlace para que puedas basarte en √©l para el nuevo tama√±o. Ser√° √∫til definir una funci√≥n que actualice el tama√±o, tanto el enlace como el estilo del globo en el DOM, para que puedas llamarla desde tu manejador de eventos, y posiblemente tambi√©n una vez al inicio, para establecer el tama√±o inicial.</p>

<p><a class="p_ident" id="p-CMyziBQORi" href="#p-CMyziBQORi" tabindex="-1" role="presentation"></a>Puedes cambiar el globo por una explosi√≥n reemplazando el nodo de texto por otro (usando <code>replaceChild</code>) o estableciendo la propiedad <code>textContent</code> de su nodo padre en una nueva cadena.</p>

</div></details>

<h3><a class="i_ident" id="i-TacKwba7GU" href="#i-TacKwba7GU" tabindex="-1" role="presentation"></a>Estela del rat√≥n</h3>

<p><a class="p_ident" id="p-NWvuUYSxYN" href="#p-NWvuUYSxYN" tabindex="-1" role="presentation"></a>En los primeros d√≠as de JavaScript, que fue la √©poca dorada de las p√°ginas de inicio estridentes con un mont√≥n de im√°genes animadas, la gente ide√≥ formas verdaderamente inspiradoras de usar el lenguaje.</p>

<p><a class="p_ident" id="p-SIIG63wuy4" href="#p-SIIG63wuy4" tabindex="-1" role="presentation"></a>Una de estas era la <em>estela del rat√≥n</em> ‚Äîuna serie de elementos que seguir√≠an al puntero del rat√≥n mientras lo mov√≠as por la p√°gina.</p>

<p><a class="p_ident" id="p-o0XuQJDBDN" href="#p-o0XuQJDBDN" tabindex="-1" role="presentation"></a>En este ejercicio, quiero que implementes una estela del rat√≥n. Utiliza elementos <code>&lt;div&gt;</code> con posici√≥n absoluta y un tama√±o fijo y color de fondo (consulta el <a href="15_event.html#mouse_drawing">c√≥digo</a> en la secci√≥n de ‚ÄúClics de rat√≥n‚Äù para un ejemplo). Crea un mont√≥n de estos elementos y, al mover el rat√≥n, mu√©stralos en la estela del puntero del rat√≥n.</p>

<p><a class="p_ident" id="p-bPEwHFdsMX" href="#p-bPEwHFdsMX" tabindex="-1" role="presentation"></a>Hay varias aproximaciones posibles aqu√≠. Puedes hacer tu soluci√≥n tan simple o tan compleja como desees. Una soluci√≥n simple para empezar es mantener un n√∫mero fijo de elementos de estela y recorrerlos, moviendo el siguiente a la posici√≥n actual del rat√≥n cada vez que ocurra un evento <code>&quot;mousemove&quot;</code>.</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-KdGRA3qkq2" href="#c-KdGRA3qkq2" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">style</span>&gt;
  .trail { <span class="tok-comment">/* nombre de clase para los elementos de la estela */</span>
    position: <span class="tok-atom">absolute</span>;
    height: <span class="tok-number">6</span><span class="tok-keyword">px</span>; width: <span class="tok-number">6</span><span class="tok-keyword">px</span>;
    border-radius: <span class="tok-number">3</span><span class="tok-keyword">px</span>;
    background: <span class="tok-atom">teal</span>;
  }
  <span class="tok-typeName">body</span> {
    height: <span class="tok-number">300</span><span class="tok-keyword">px</span>;
  }
&lt;/<span class="tok-typeName">style</span>&gt;

```html
&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-comment">// Tu c√≥digo aqu√≠.</span>
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<details class="solution"><summary>Mostrar pistas...</summary><div class="solution-text">

<p><a class="p_ident" id="p-4AFLKpPOlK" href="#p-4AFLKpPOlK" tabindex="-1" role="presentation"></a>Crear los elementos es mejor hacerlo con un bucle. Adj√∫ntalos al documento para que aparezcan. Para poder acceder a ellos m√°s tarde y cambiar su posici√≥n, querr√°s almacenar los elementos en un array.</p>

<p><a class="p_ident" id="p-O7Vg4b4/gp" href="#p-O7Vg4b4/gp" tabindex="-1" role="presentation"></a>Recorrerlos se puede hacer manteniendo una variable de contador y sum√°ndole 1 cada vez que se dispare el evento <code>&quot;mousemove&quot;</code>. Luego se puede usar el operador de resto (<code>% elementos.<wbr>length</code>) para obtener un √≠ndice de array v√°lido para elegir el elemento que deseas posicionar durante un evento dado.</p>

<p><a class="p_ident" id="p-sJ/RGv4SnV" href="#p-sJ/RGv4SnV" tabindex="-1" role="presentation"></a>Otro efecto interesante se puede lograr modelando un simple sistema de f√≠sica. Usa el evento <code>&quot;mousemove&quot;</code> solo para actualizar un par de enlaces que siguen la posici√≥n del rat√≥n. Luego utiliza <code>requestAnimationFrame</code> para simular que los elementos rastreadores son atra√≠dos a la posici√≥n del puntero del rat√≥n. En cada paso de animaci√≥n, actualiza su posici√≥n bas√°ndote en su posici√≥n relativa al puntero (y, opcionalmente, una velocidad que est√° almacenada para cada elemento). Descubrir una buena forma de hacer esto queda a tu cargo.</p>

</div></details>

<h3><a class="i_ident" id="i-FBlz6I/AHB" href="#i-FBlz6I/AHB" tabindex="-1" role="presentation"></a>Pesta√±as</h3>

<p><a class="p_ident" id="p-GiuPPAqneR" href="#p-GiuPPAqneR" tabindex="-1" role="presentation"></a>Los paneles con pesta√±as son ampliamente utilizados en interfaces de usuario. Te permiten seleccionar un panel de interfaz eligiendo entre varias pesta√±as que sobresalen por encima de un elemento.</p>

<p><a class="p_ident" id="p-oCfJg8pvnS" href="#p-oCfJg8pvnS" tabindex="-1" role="presentation"></a>En este ejercicio debes implementar una interfaz de pesta√±as simple. Escribe una funci√≥n, <code>asTabs</code>, que tome un nodo DOM y cree una interfaz de pesta√±as que muestre los elementos secundarios de ese nodo. Deber√≠a insertar una lista de elementos <code>&lt;button&gt;</code> en la parte superior del nodo, uno por cada elemento secundario, conteniendo el texto recuperado del atributo <code>data-tabname</code> del hijo. Todos los hijos originales excepto uno deben estar ocultos (con un estilo <code>display</code> de <code>none</code>). El nodo actualmente visible se puede seleccionar haciendo clic en los botones.</p>

<p><a class="p_ident" id="p-A5yNkNAmF9" href="#p-A5yNkNAmF9" tabindex="-1" role="presentation"></a>Cuando funcione, exti√©ndelo para dar estilo al bot√≥n de la pesta√±a actualmente seleccionada de manera diferente para que sea obvio cu√°l pesta√±a est√° seleccionada.</p>

<pre tabindex="0" class="snippet" data-language="html" ><a class="c_ident" id="c-IPOlbViOlf" href="#c-IPOlbViOlf" tabindex="-1" role="presentation"></a>&lt;<span class="tok-typeName">tab-panel</span>&gt;
  &lt;<span class="tok-typeName">div</span> data-tabname=<span class="tok-string">&quot;one&quot;</span>&gt;Pesta√±a uno&lt;/<span class="tok-typeName">div</span>&gt;
  &lt;<span class="tok-typeName">div</span> data-tabname=<span class="tok-string">&quot;two&quot;</span>&gt;Pesta√±a dos&lt;/<span class="tok-typeName">div</span>&gt;
  &lt;<span class="tok-typeName">div</span> data-tabname=<span class="tok-string">&quot;three&quot;</span>&gt;Pesta√±a tres&lt;/<span class="tok-typeName">div</span>&gt;
&lt;/<span class="tok-typeName">tab-panel</span>&gt;

&lt;<span class="tok-typeName">script</span>&gt;
  <span class="tok-keyword">function</span> <span class="tok-definition">asTabs</span>(<span class="tok-definition">node</span>) {
    <span class="tok-comment">// Tu c√≥digo aqu√≠.</span>
  }
  asTabs(document.querySelector(<span class="tok-string">&quot;tab-panel&quot;</span>));
&lt;/<span class="tok-typeName">script</span>&gt;</pre>

<details class="solution"><summary>Mostrar pistas...</summary><div class="solution-text">

<p><a class="p_ident" id="p-S/jD91+7re" href="#p-S/jD91+7re" tabindex="-1" role="presentation"></a>Un error en el que podr√≠as caer es que no puedes usar directamente la propiedad <code>childNodes</code> del nodo como una colecci√≥n de nodos de pesta√±a. Por un lado, cuando agregas los botones, tambi√©n se convertir√°n en nodos secundarios y terminar√°n en este objeto porque es una estructura de datos en vivo. Por otro lado, los nodos de texto creados para el espacio en blanco entre los nodos tambi√©n est√°n en <code>childNodes</code> pero no deber√≠an tener sus propias pesta√±as. Puedes usar <code>children</code> en lugar de <code>childNodes</code> para ignorar los nodos de texto.</p>

<p><a class="p_ident" id="p-kghgg4c48e" href="#p-kghgg4c48e" tabindex="-1" role="presentation"></a>Podr√≠as empezar construyendo un array de pesta√±as para tener f√°cil acceso a ellas. Para implementar el estilo de los botones, podr√≠as almacenar objetos que contengan tanto el panel de la pesta√±a como su bot√≥n.</p>

<p><a class="p_ident" id="p-wCOFQx+NM/" href="#p-wCOFQx+NM/" tabindex="-1" role="presentation"></a>Recomiendo escribir una funci√≥n separada para cambiar las pesta√±as. Puedes almacenar la pesta√±a seleccionada previamente y cambiar solo los estilos necesarios para ocultarla y mostrar la nueva, o puedes actualizar el estilo de todas las pesta√±as cada vez que se seleccione una nueva pesta√±a.</p>

<p><a class="p_ident" id="p-snuxXmN8m+" href="#p-snuxXmN8m+" tabindex="-1" role="presentation"></a>Quiz√°s quieras llamar a esta funci√≥n inmediatamente para que la interfaz comience con la primera pesta√±a visible.</p>

</div></details><nav><a href="14_dom.html" title="previous chapter" aria-label="previous chapter">‚óÇ</a>¬†<a href="index.html" title="cover" aria-label="cover">‚óè</a>¬†<a href="16_game.html" title="next chapter" aria-label="next chapter">‚ñ∏</a>&nbsp;<button class=help title="help" aria-label="help"><strong>?</strong></button>&nbsp;<button class="dark-mode-toggle">üåô</button>
</nav>
</article>

<script src="ejs.js"></script>
